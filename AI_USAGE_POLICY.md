# AI利用ポリシー（テンプレ）

この文書は、生成AI（例：Copilot、ChatGPT など）を活用して Issue / Pull Request / ドキュメントを作成・更新する際の、最小限の運用ルールです。

## 目的

- AI 支援を使っても、品質と安全性（誤情報・誤設定・機密漏えいの防止）を維持する。
- 「誰が何を確認したか」を Pull Request に残し、検証責任を曖昧にしない。

## 適用範囲

- このリポジトリへの Issue 作成、Pull Request 作成、ドキュメント更新

## 基本原則

- **最終責任は人間が持つ**：AI の出力は提案であり、正しさは保証されない。
- **検証可能性を優先する**：再現手順・確認方法・根拠を残す。
- **最小変更・段階導入**：大きな修正は分割し、レビュー可能な単位にする。

## 禁止事項（Must Not）

- **機密情報・個人情報を入力しない**
  - 例：トークン、パスワード、秘密鍵、顧客情報、社内限定資料
- **根拠が確認できない内容を断定しない**
  - 不明な場合は「要確認」と明示し、確認観点を Issue に残す。
- **ライセンス不明な文章・画像・コードを持ち込まない**
  - 参照元と利用条件が確認できない場合は採用しない。

## 推奨運用（Should）

### Pull Request の作成時

- `.github/PULL_REQUEST_TEMPLATE.md` の「AI支援の開示（任意）」を埋める。
  - AI 支援を使った場合は **「どこに使ったか」** と **「人間が確認した観点」** を明記する。

### CLI でコメント投稿する場合（`gh` 等）

GitHub CLI（`gh`）等を使って PR/Issue コメントを投稿する場合、シェル（例：Bash）のクォート仕様により **意図しないコマンド実行やコマンド出力の混入** が起きる可能性があります。特に Bash ではバッククォート `` `...` `` がコマンド置換として評価されます。

対策として、コメント本文は `--body`（`-b`）で直接渡さず、**`--body-file`（`-F`）でファイルから渡す**運用を推奨します。

```bash
# 本文をファイルに書いてから投稿（推奨）
cat > /tmp/pr-comment.md <<'EOF'
チェック結果: PASS
変更内容は `git diff` を確認済み。
EOF

gh pr comment 123 -F /tmp/pr-comment.md
```

補足：
- ログやコマンド出力を貼る場合は、貼付前に機密情報（トークン・秘密鍵等）が含まれていないか確認し、必要に応じて `***` でマスクします。
- `--body`（`-b`）で本文を渡す場合でも、バッククォートの取り扱いに注意し、可能なら `--body-file` に寄せます。

### AI 生成の典型的な誤り（チェックリスト）

AI 支援を使った変更は、少なくとも次を確認してください。

- [ ] **リンク**：リンク先が存在し、意図したページに到達する
- [ ] **事実関係**：用語定義・前提・仕様が本文と矛盾しない
- [ ] **手順/コマンド**：手順が省略されていない（前提条件・注意事項を含む）
- [ ] **設定値**：パス・ファイル名・キー名が実在し、表記揺れがない
- [ ] **セキュリティ**：機密情報を含まない／危険な手順が推奨されていない
- [ ] **読者前提**：初心者がつまずきやすい箇所に補足がある

## 参考

- PRテンプレ：`.github/PULL_REQUEST_TEMPLATE.md`
- docs品質ゲート：`.github/workflows/docs-quality-gate.yml`
